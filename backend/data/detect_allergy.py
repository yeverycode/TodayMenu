import pandas as pd
import csv

# 파일 경로
file_path = "C:/TodayMenu/gal_menu_data.csv"

# 불러오기
df = pd.read_csv(file_path)

allergy_keywords = {

    "달걀": [
    "계란", "달걀", "에그", "지단", "오믈렛", "스크램블", "에그마요", "계란찜", "계란말이",
    "계란후라이", "계란볶음", "달걀찜", "타마고", "계란탕", "계란국", "에그드랍", "깜파뉴",
    "마요네즈", "계란구이", "전", "부침", "에그베네딕트","휘낭시에", "쿠키","돈가스","김밥"
  ],
  "갑각류": [
    "새우", "게", "랍스터", "크랩", "꽃게", "대게", "킹크랩", "소프트크랩", "새우살", "홍게", "게살", "게장", "간장게장", "양념게장",
    "크랩", "가재", "소프틱크랩", "민물새우", "바닷가재", "새우까스", "새우완자", "새우전",
    "모듬해물", "칠리새우", "마늘새우", "버터새우", "해물요리", "감바스", "쉬림프"
  ],
  "밀": [
    "빵", "파스타", "스파게티", "면", "누들", "크로와상", "라면", "우동", "만두", "피자", "떡국", 
    "짜장", "짬뽕", "튀김", "꽃빵", "탕수육", "샌드위치", "떡볶이", "로제", "수제비", "팬케이크", "러스크",
    "와플", "베이글", "부대찌개", "냉면", "마라탕", "국수", "짜장면", "쟁반짜장", "볶음면","브리또","타코야키",
    "비빔면", "칼국수", "잔치국수", "콘크림파스타", "카르보나라", "알리오올리오", "메밀", "찐빵", "깜파뉴","까스",
    "호떡", "도넛", "쿠키", "카스테라", "파이", "토스트", "프레첼", "식빵", "바게트", "치아바타","꿔바로우",
    "포카치아", "피타", "나쵸", "타코", "부리또", "통밀", "밀가루", "어묵", "핫도그","가스","동","떡",
    "다시마국수", "쫄면", "막국수", "동치미국수", "물냉면", "비빔냉면", "온면", "초계국수","돈가스","버거", "라멘","짜빠구리"
  ],
  "땅콩/대두": [
    "땅콩", "콩", "대두", "두부", "된장", "청국장", "콩국수", "콩비지", "두유", "미소된장",
    "콩물", "콩나물", "숙주나물", "간장", "고추장", "쌈장", "맛된장", "미소", "들깨", "들기름",
    "참기름", "비지", "순두부", "연두부", "모두부", "부침두부", "유부", "유부초밥", "순두부찌개",
    "된장찌개", "땅콩소스", "땅콩버터", "두부조림", "콩불", "콩자반", "된장국", "청국장찌개",
    "두부튀김", "두부김치", "묵", "콩비지찌개", "완두콩", "병아리콩", "블랙빈", "팥", "팥빙수",
    "팥죽", "콩비지전", "파마산치즈", "체다치즈"  
  ],
  "고기": [
    "불고기", "제육", "소불백", "돼지불백", "닭", "돈까스", "스테이크", "햄", "베이컨", "닭도리탕", 
    "순대", "갈비", "양념갈비", "삼겹살", "족발", "보쌈", "차슈", "햄버거", "로스트", "토시살", "삼겹", "오겹", "껍데기", "꼬들살",
    "소", "돼지", "계육", "닭갈비", "닭볶음탕", "닭강정", "양념치킨", "후라이드","곱창", "대창", "막창","갈매기살", "항정살","반계탕", "계",
    "치킨", "소갈비탕", "갈비탕", "곰탕", "설렁탕", "육개장", "순대국", "소머리국밥", "돼지국밥","꼬들","목살","함박","불백",
    "삼계탕", "백숙", "닭죽", "육회", "떡갈비", "육사시미", "간", "곱창", "돼지껍데기", "소시지", "안심", "등심", "채끝", "안창살", "차돌박이", "우설", "육포",
    "스테이크", "햄버거 패티", "소꼬리", "족발", "보쌈", "수육", "바베큐", "그릴드 치킨", "BBQ","염통","차돌", "램", "윙","히레"
  ],
  "우유": [
    "라떼", "크림", "생크림", "치즈", "리코타", "밀크", "버터", "모카", "까페라떼", "아인슈페너", 
    "우유", "요거트", "화이트소스", "밀크티", "퐁듀", "리조또", "스프", "스튜", "로제", "카페라떼",
    "바닐라라떼", "카라멜라떼", "카푸치노", "모카프라푸치노", "우유식빵", "체다", "파마산", "모짜렐라",
    "치즈케익", "치즈볼", "치즈스틱", "크림파스타", "크림스프", "크림리조또", "치즈돈까스", "치즈떡볶이",
    "그라탕", "오그라탕", "카르보나라", "알프레도", "푸딩", "슈크림", "아이스크림", "젤라또",
    "요구르트", "치즈버거", "치즈샌드위치", "치즈파스타", "마카로니치즈", "블루치즈", "고르곤졸라",
    "마스카포네", "화이트초콜릿", "밀크초콜릿", "연유", "콘덴스밀크", "휘핑크림", "버터", "쉐이크","휘낭시에"
  ]
}

# 알러지 판별
def detect_allergy(menu_name):
    detected_allergies = []
    for allergy, keywords in allergy_keywords.items():
        if any(keyword in str(menu_name) for keyword in keywords):
            detected_allergies.append(allergy)
    if not detected_allergies:
        return "없음"
    return ', '.join(detected_allergies)  # 큰따옴표 없이 컴마만

# 적용
df["allergy"] = df["menu_name"].apply(detect_allergy)

# 저장
df.to_csv(file_path, index=False, encoding="utf-8-sig", quoting=csv.QUOTE_MINIMAL)

print("저장 완료되었습니다.")
